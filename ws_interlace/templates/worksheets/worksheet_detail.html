{% extends 'base.html' %}
{% block title %}
    {{ worksheet.name }}
    -
    {{ block.super }}
{% endblock title %}
{% block content %}
    <div class="panel panel-default" style="width: 75%; margin-left: 2%;">
        <!-- Default panel contents -->
        <div class="panel-heading">
            <h3 class="panel-title">{{ worksheet.name }}
                Data</h3>
        </div>
        <div class="panel-body">
            <p>{{ worksheet.description }}</p>
        </div>
        {% if answers %}
            <table class=" table table-inverse">
                <thead>
                    <tr>
                        <th>Student</th>
                        <th>Image</th>
                        <th>Answer</th>
                    </tr>
                </thead>
                <tbody>
                    {% for answer in answers %}
                        <tr>
                            <td>{{ answer.student_name}}</td>
                            <td>
                                <a href="{{ answer.img_url }}">{{ answer.img_url }}</a>
                            </td>
                            <td>{{ answer.num }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div style="width: 75%; margin-left: 2%;" class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Charts</h3>
            </div>
            <script type="text/javascript">
                // Load the Visualization API and the corechart package.
                google.charts.load('current', {
                    'packages': ['bar', 'corechart']
                });

                // Set a callback to run when the Google Visualization API is loaded.
                google.charts.setOnLoadCallback(drawChart);

                // Callback that creates and populates a data table, instantiates the pie chart, passes in the data and draws it.
                function drawChart() {

                    // Create the data table.
                    var data = new google.visualization.DataTable();

                    data.addColumn('string', 'Student');
                    data.addColumn('number', 'Answer');

                    {% for answer in ws_answers %}
                        data.addRow(['{{ answer.student_name }}', {{ answer.num }}]);
                    {% endfor %}

                    var options = {
                        chart: {
                            title: ''
                        },
                        bars: 'horizontal',
                        width: 300,
                        height: 170,
                        legend: {
                            position: 'none'
                        },
                        axes: {
                            y: {
                                0: {
                                    side: 'top',
                                    label: ''
                                } // Top x-axis.
                            }
                        }
                    };

                    // Instantiate and draw our chart, passing in some options.
                    var chart = new google.charts.Bar(document.getElementById('chart_div'));
                    chart.draw(data, google.charts.Bar.convertOptions(options));

                }
            </script>

            <!--Div that will hold the bar chart-->

            <div class="panel-body chart">
                <div id="chart_div" style="margin: 50px; "></div>
            </div>

        </div>

    {% endif %}
{% endblock content %}
