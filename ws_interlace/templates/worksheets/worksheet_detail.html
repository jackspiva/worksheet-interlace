{% extends 'base.html' %}
{% block title %}
    {{ worksheet.title }}
    -
    {{ block.super }}
{% endblock title %}
{% block content %}
    <div class="panel panel-default">
        <!-- Default panel contents -->
        <div class="panel-heading">
            <h3 class="panel-title">{{ worksheet.title }}</h3>
        </div>
        <div class="panel-body">
            <p>{{ worksheet.description }}</p>
        </div>
        {% if answers %}
            <table class="table table-striped table-hover table-inverse">
                <thead>
                    <tr>
                        <th>Student</th>
                        <th>Answer 1</th>
                        <th>Answer 2</th>
                    </tr>
                </thead>
                <tbody>
                    {% for answer in answers %}
                        <tr>
                            <td>{{ answer.student}}</td>
                            <td>{{ answer.text }}</td>
                            <td>{{ answer.num }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div style="margin-left:50px; margin-top:30px;">

            <script type="text/javascript">
                // Load the Visualization API and the corechart package.
                google.charts.load('current', {
                    'packages': ['bar', 'corechart']
                });

                // Set a callback to run when the Google Visualization API is loaded.
                google.charts.setOnLoadCallback(drawChart);

                // Callback that creates and populates a data table, instantiates the pie chart, passes in the data and draws it.
                function drawChart() {

                    // Create the data table.
                    var data = new google.visualization.DataTable();

                    data.addColumn('string', 'Student');
                    data.addColumn('number', 'Answer');

                    {% for answer in ws_answers %}
                        data.addRow(['{{answer.student }}', {{ answer.num }}]);
                    {% endfor %}

                    var options = {
                        chart: {
                            title: 'Numerical Answers'
                        },
                        bars: 'horizontal',
                        width: 300,
                        height: 300,
                        legend: {
                            position: 'none'
                        },
                        axes: {
                            y: {
                                0: {
                                    side: 'top',
                                    label: ''
                                } // Top x-axis.
                            }
                        }
                    };

                    // Instantiate and draw our chart, passing in some options.
                    var chart = new google.charts.Bar(document.getElementById('chart_div'));
                    chart.draw(data, google.charts.Bar.convertOptions(options));

                }
            </script>

            <!--Div that will hold the pie chart-->
            <table class="table-bordered">
                <tr>
                    <td>
                        <div class="chart">
                            <div id="chart_div" style="margin: 50px; "></div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>

    {% endif %}
{% endblock content %}
